<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multilingual AI Content Detector</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <style>
        /* Mantenha todo o CSS anterior (omito para brevidade) */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Multilingual AI Content Detector</h1>
            <p>Focus on unequivocal generative AI patterns across languages</p>
        </header>

        <div class="main-content">
            <div class="upload-section">
                <h2>Submit Content for Analysis</h2>
                <div class="upload-area" id="uploadArea">
                    <i>üìÑ</i>
                    <h3>Drag and drop files here</h3>
                    <p>or click to select</p>
                    <p>Supported formats: PDF, DOCX, DOC, TXT</p>
                    <input type="file" id="fileInput" class="file-input" accept=".pdf,.docx,.doc,.txt">
                </div>
                
                <div>
                    <h3>Or paste text below:</h3>
                    <textarea id="textInput" placeholder="Paste your text here for analysis..." rows="10" style="width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 8px; margin: 10px 0; font-family: inherit;"></textarea>
                </div>
                
                <div>
                    <h3>Content Type:</h3>
                    <select id="contentType" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin: 10px 0;">
                        <option value="academic">Academic</option>
                        <option value="creative">Creative</option>
                        <option value="technical">Technical</option>
                        <option value="business">Business</option>
                        <option value="casual">Casual</option>
                    </select>
                </div>

                <div>
                    <h3>Language Detection:</h3>
                    <select id="languageSelect" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin: 10px 0;">
                        <option value="auto">Auto-detect</option>
                        <option value="en">English</option>
                        <option value="pt">Portuguese</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <button class="btn" id="analyzeBtn">Analyze Content</button>
                <button class="btn btn-secondary" id="clearBtn">Clear</button>
            </div>

            <div class="results-section">
                <h2>Analysis Results</h2>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Analyzing content with advanced multilingual metrics...</p>
                </div>
                
                <div class="results-container" id="resultsContainer">
                    <!-- Mantenha a estrutura de resultados existente -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°vel global para armazenar resultados atuais
        let currentAnalysisResult = null;

        // DETEC√á√ÉO AUTOM√ÅTICA DE IDIOMA
        function detectLanguage(text) {
            const commonWords = {
                'en': ['the', 'and', 'of', 'to', 'a', 'in', 'is', 'it', 'you', 'that'],
                'pt': ['o', 'a', 'e', 'de', 'do', 'da', 'em', 'um', 'para', 'com'],
                'es': ['el', 'la', 'de', 'que', 'y', 'en', 'un', 'es', 'se', 'no'],
                'fr': ['le', 'la', 'de', 'et', '√†', 'en', 'un', 'une', 'est', 'pour'],
                'de': ['der', 'die', 'das', 'und', 'in', 'den', 'von', 'zu', 'ist', 'sich'],
                'it': ['il', 'la', 'e', 'di', 'che', 'in', 'un', 'una', 'per', 'con']
            };

            const words = text.toLowerCase().split(/\s+/);
            let scores = {};
            
            Object.keys(commonWords).forEach(lang => {
                scores[lang] = 0;
                commonWords[lang].forEach(word => {
                    if (words.includes(word)) scores[lang]++;
                });
            });

            const detectedLang = Object.keys(scores).reduce((a, b) => 
                scores[a] > scores[b] ? a : b
            );

            return scores[detectedLang] > 2 ? detectedLang : 'other';
        }

        // PADR√ïES UNIVERSAIS DE IA (funcionam em qualquer idioma)
        const universalAIPatterns = [
            {
                pattern: /\b(?:\+1|\+2|\+3|\+4)\b/g,
                weight: 40,
                description: "Loose reference markers - CHATGPT PATTERN"
            },
            {
                pattern: /\b(?:PMC|UNESCO|ResearchGate|Taylor & Francis|Internet Archive)\s*[\+\d]+\b/gi,
                weight: 45,
                description: "References with artificial markers (+1, +2) - AI EXCLUSIVE"
            },
            {
                pattern: /\.\s*(?:PMC|UNESCO|ResearchGate)\s*$/gm,
                weight: 40,
                description: "Loose references at sentence ends - AI ARTIFACT"
            },
            {
                pattern: /\([^)]*\)\s*(?:PMC|UNESCO|ResearchGate)/gi,
                weight: 35,
                description: "Parenthetical references with markers"
            },
            {
                pattern: /\b(?:furthermore|moreover|additionally|however|therefore|consequently)\s*,\s*\b(?:furthermore|moreover|additionally|however|therefore|consequently)/gi,
                weight: 25,
                description: "Repetitive transitional phrases"
            },
            {
                pattern: /\b(?:it is important to note that|it should be noted that|it is worth mentioning that)\b/gi,
                weight: 20,
                description: "Generic academic filler phrases"
            },
            {
                pattern: /\b(?:this (?:study|paper|research) (?:aims to|seeks to|attempts to)\b/gi,
                weight: 18,
                description: "Generic academic objective structures"
            }
        ];

        // PADR√ïES DE IA ESPEC√çFICOS POR IDIOMA
        const languageSpecificAIPatterns = {
            'en': [
                {
                    pattern: /\b(?:In conclusion|To summarize|In summary)\s*,\s*\b(?:this|the)\b/gi,
                    weight: 22,
                    description: "Standardized conclusion phrases - ENGLISH AI"
                },
                {
                    pattern: /\b(?:It is recommended that|It is suggested that)\s+(?:further|additional)\b/gi,
                    weight: 20,
                    description: "Impersonal recommendation structures - ENGLISH AI"
                }
            ],
            'pt': [
                {
                    pattern: /\b(?:Conclui-se que|Recomenda-se que|Sugere-se que)\b/gi,
                    weight: 22,
                    description: "Estruturas impessoais padronizadas - IA PORTUGU√äS"
                },
                {
                    pattern: /\b(?:este|o presente)\s+(?:artigo|estudo)\s+(?:tem como objetivo|busca|visa)\b/gi,
                    weight: 20,
                    description: "Estrutura gen√©rica de objetivo acad√™mico - IA PORTUGU√äS"
                }
            ],
            'es': [
                {
                    pattern: /\b(?:Se concluye que|Se recomienda que|Se sugiere que)\b/gi,
                    weight: 22,
                    description: "Estructuras impersonales estandarizadas - IA ESPA√ëOL"
                },
                {
                    pattern: /\b(?:este|el presente)\s+(?:art√≠culo|estudio)\s+(?:tiene como objetivo|busca|pretende)\b/gi,
                    weight: 20,
                    description: "Estructura gen√©rica de objetivo acad√©mico - IA ESPA√ëOL"
                }
            ],
            'fr': [
                {
                    pattern: /\b(?:On conclut que|Il est recommand√© que|Il est sugg√©r√© que)\b/gi,
                    weight: 22,
                    description: "Structures impersonnelles standardis√©es - IA FRAN√áAIS"
                },
                {
                    pattern: /\b(?:cet|le pr√©sent)\s+(?:article|√©tude)\s+(?:a pour objectif|cherche|vise)\b/gi,
                    weight: 20,
                    description: "Structure g√©n√©rique d'objectif acad√©mique - IA FRAN√áAIS"
                }
            ]
        };

        // PADR√ïES HUMANOS UNIVERSAIS
        const universalHumanPatterns = [
            {
                pattern: /[^.!?]{120,}[.!?]/g,
                weight: 15,
                description: "Long complex sentences with multiple ideas"
            },
            {
                pattern: /(?:"[^"]*"|'[^']*')/g,
                weight: 15,
                description: "Direct quotations and dialogues"
            },
            {
                pattern: /[A-Za-z]+\set\s\.[A-Za-z]/g,
                weight: 12,
                description: "Academic abbreviations with 'et al.'"
            },
            {
                pattern: /[!?]{2,}/g,
                weight: 10,
                description: "Expressive punctuation (rare in AI)"
            },
            {
                pattern: /\b(?:perhaps|probably|possibly|apparently|eventually)\b/gi,
                weight: 18,
                description: "Expressions of uncertainty and probability"
            },
            {
                pattern: /\b(?:unfortunately|fortunately|interestingly|surprisingly|curiously)\b/gi,
                weight: 20,
                description: "Expressions of subjective evaluation"
            }
        ];

        // PADR√ïES HUMANOS ESPEC√çFICOS POR IDIOMA
        const languageSpecificHumanPatterns = {
            'en': [
                {
                    pattern: /\b(?:I think|I believe|in my opinion|from my perspective|it seems to me)\b/gi,
                    weight: 30,
                    description: "Explicit personal opinion expressions - STRONG HUMAN INDICATOR"
                },
                {
                    pattern: /\b(?:we observe|we notice|we feel|we believe|we question)\b/gi,
                    weight: 25,
                    description: "Personal observation and positioning"
                }
            ],
            'pt': [
                {
                    pattern: /\b(?:parece-me|ao meu ver|na minha opini√£o|do meu ponto de vista|penso que|acho que)\b/gi,
                    weight: 30,
                    description: "Express√µes de opini√£o pessoal expl√≠cita - FORTE INDICADOR HUMANO"
                },
                {
                    pattern: /\b(?:observamos|percebemos|sentimos|acreditamos|questionamos)\b/gi,
                    weight: 25,
                    description: "Express√µes de observa√ß√£o e posicionamento pessoal"
                }
            ],
            'es': [
                {
                    pattern: /\b(?:me parece|en mi opini√≥n|desde mi punto de vista|pienso que|creo que)\b/gi,
                    weight: 30,
                    description: "Expresiones de opini√≥n personal expl√≠cita - FUERTE INDICADOR HUMANO"
                },
                {
                    pattern: /\b(?:observamos|notamos|sentimos|creemos|cuestionamos)\b/gi,
                    weight: 25,
                    description: "Expresiones de observaci√≥n y posicionamiento personal"
                }
            ],
            'fr': [
                {
                    pattern: /\b(?:il me semble|√† mon avis|de mon point de vue|je pense que|je crois que)\b/gi,
                    weight: 30,
                    description: "Expressions d'opinion personnelle explicite - FORT INDICATEUR HUMAIN"
                },
                {
                    pattern: /\b(?:nous observons|nous remarquons|nous sentons|nous croyons|nous questionnons)\b/gi,
                    weight: 25,
                    description: "Expressions d'observation et de positionnement personnel"
                }
            ]
        };

        // Fun√ß√£o para detectar padr√µes com base no idioma
        function detectAIPatterns(text, language) {
            let totalScore = 0;
            const detectedPatterns = [];
            
            // Padr√µes universais
            universalAIPatterns.forEach(patternObj => {
                const matches = text.match(patternObj.pattern);
                if (matches && matches.length > 0) {
                    const score = Math.min(matches.length * patternObj.weight, 100);
                    totalScore += score;
                    
                    detectedPatterns.push({
                        pattern: patternObj.pattern.source.substring(0, 50) + '...',
                        matches: matches.length,
                        description: patternObj.description,
                        examples: matches.slice(0, 5),
                        score: score
                    });
                }
            });
            
            // Padr√µes espec√≠ficos do idioma
            if (languageSpecificAIPatterns[language]) {
                languageSpecificAIPatterns[language].forEach(patternObj => {
                    const matches = text.match(patternObj.pattern);
                    if (matches && matches.length > 0) {
                        const score = Math.min(matches.length * patternObj.weight, 100);
                        totalScore += score;
                        
                        detectedPatterns.push({
                            pattern: patternObj.pattern.source.substring(0, 50) + '...',
                            matches: matches.length,
                            description: patternObj.description,
                            examples: matches.slice(0, 5),
                            score: score
                        });
                    }
                });
            }
            
            return {
                patterns: detectedPatterns,
                totalScore: totalScore,
                normalizedScore: Math.min(totalScore / 5, 80)
            };
        }

        function detectHumanPatterns(text, language) {
            let totalScore = 0;
            const detectedPatterns = [];
            
            // Padr√µes universais
            universalHumanPatterns.forEach(patternObj => {
                const matches = text.match(patternObj.pattern);
                if (matches && matches.length > 0) {
                    const score = Math.min(matches.length * patternObj.weight, 60);
                    totalScore += score;
                    
                    detectedPatterns.push({
                        pattern: patternObj.pattern.source.substring(0, 50) + '...',
                        matches: matches.length,
                        description: patternObj.description,
                        examples: matches.slice(0, 3),
                        score: score
                    });
                }
            });
            
            // Padr√µes espec√≠ficos do idioma
            if (languageSpecificHumanPatterns[language]) {
                languageSpecificHumanPatterns[language].forEach(patternObj => {
                    const matches = text.match(patternObj.pattern);
                    if (matches && matches.length > 0) {
                        const score = Math.min(matches.length * patternObj.weight, 60);
                        totalScore += score;
                        
                        detectedPatterns.push({
                            pattern: patternObj.pattern.source.substring(0, 50) + '...',
                            matches: matches.length,
                            description: patternObj.description,
                            examples: matches.slice(0, 3),
                            score: score
                        });
                    }
                });
            }
            
            return {
                patterns: detectedPatterns,
                totalScore: totalScore,
                normalizedScore: Math.min(totalScore / 8, 70)
            };
        }

        // Inicializa√ß√£o quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function() {
            // ... (mantenha todo o c√≥digo de inicializa√ß√£o existente)

            // Modifique a fun√ß√£o advancedAnalyzeContent
            async function advancedAnalyzeContent(text, contentType) {
                // Detectar idioma
                const selectedLanguage = document.getElementById('languageSelect').value;
                const detectedLanguage = selectedLanguage === 'auto' ? detectLanguage(text) : selectedLanguage;
                
                // Simular processamento
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // M√©tricas b√°sicas
                const wordCount = text.split(/\s+/).length;
                const sentenceCount = text.split(/[.!?]+/).length - 1;
                const paragraphCount = text.split(/\n\s*\n/).length;
                
                // An√°lises principais com suporte multil√≠ngue
                const lexicalRichness = calculateLexicalRichness(text);
                const sentenceVariety = analyzeSentenceVariety(text);
                const aiPatternAnalysis = detectAIPatterns(text, detectedLanguage);
                const humanPatternAnalysis = detectHumanPatterns(text, detectedLanguage);
                
                // C√ÅLCULO DO SCORE - Adaptado para multil√≠ngue
                let humanScore = 50; // Base neutra
                
                // PADR√ïES FORTES DE IA S√ÉO DECISIVOS
                humanScore -= aiPatternAnalysis.normalizedScore;
                
                // PADR√ïES HUMANOS ADICIONAM B√îNUS
                humanScore += humanPatternAnalysis.normalizedScore;
                
                // RIQUEZA LEXICAL - B√¥nus moderado
                if (lexicalRichness > 35) humanScore += 8;
                else if (lexicalRichness > 25) humanScore += 4;
                else if (lexicalRichness < 10) humanScore -= 5;
                
                // VARIEDADE DE FRASES - B√¥nus moderado
                if (sentenceVariety > 0.7) humanScore += 6;
                else if (sentenceVariety > 0.5) humanScore += 3;
                else if (sentenceVariety < 0.3) humanScore -= 4;
                
                // PADR√ïES INEQU√çVOCOS DE IA S√ÉO DECISIVOS
                const hasInequivocalIAPatterns = aiPatternAnalysis.patterns.some(p => 
                    p.description.includes('EXCLUSIVE') ||
                    p.description.includes('CHATGPT') ||
                    p.description.includes('ARTIFACT')
                );
                
                if (hasInequivocalIAPatterns) {
                    humanScore -= 40;
                    
                    const markerCount = (text.match(/\+\d+/g) || []).length;
                    if (markerCount >= 3) humanScore -= 25;
                    if (markerCount >= 6) humanScore -= 20;
                }
                
                // B√îNUS FORTES PARA PADR√ïES HUMANOS
                if (humanPatternAnalysis.patterns.some(p => p.description.includes('STRONG HUMAN') || p.description.includes('FORTE INDICADOR'))) {
                    humanScore += 15;
                }
                
                // Ajustes baseados no idioma detectado
                if (detectedLanguage === 'other') {
                    // Para idiomas n√£o suportados, reduzir confian√ßa
                    humanScore = Math.max(20, Math.min(80, humanScore));
                }
                
                const humanProbability = Math.max(5, Math.min(90, humanScore));
                const confidence = calculateConfidence(text.length, humanPatternAnalysis.normalizedScore, aiPatternAnalysis.normalizedScore);
                
                // Gerar destaques
                const textHighlights = generateTextHighlights(text, aiPatternAnalysis, humanPatternAnalysis);
                
                // Gerar sugest√µes multil√≠ngues
                const suggestions = generateMultilingualSuggestions(humanProbability, aiPatternAnalysis, humanPatternAnalysis, detectedLanguage);
                
                return {
                    humanProbability,
                    aiProbability: 100 - humanProbability,
                    analyzedText: text,
                    wordCount,
                    sentenceCount,
                    paragraphCount,
                    contentType,
                    detectedLanguage,
                    confidence,
                    advancedMetrics: {
                        aiPatternScore: Math.round(aiPatternAnalysis.normalizedScore),
                        humanPatternScore: Math.round(humanPatternAnalysis.normalizedScore),
                        lexicalRichness: Math.round(lexicalRichness),
                        sentenceVariety: Math.round(sentenceVariety * 100) / 100,
                        strongAIPatterns: aiPatternAnalysis.patterns.length,
                        strongHumanPatterns: humanPatternAnalysis.patterns.length,
                        markerCount: (text.match(/\+\d+/g) || []).length
                    },
                    aiPatternAnalysis: aiPatternAnalysis,
                    humanPatternAnalysis: humanPatternAnalysis,
                    textHighlights,
                    suggestions,
                    detailedExplanation: generateDetailedExplanation({
                        humanProbability, 
                        aiPatternScore: aiPatternAnalysis.normalizedScore,
                        humanPatternScore: humanPatternAnalysis.normalizedScore,
                        lexicalRichness,
                        sentenceVariety,
                        aiPatterns: aiPatternAnalysis.patterns,
                        humanPatterns: humanPatternAnalysis.patterns,
                        markerCount: (text.match(/\+\d+/g) || []).length,
                        language: detectedLanguage
                    })
                };
            }

            // Nova fun√ß√£o para sugest√µes multil√≠ngues
            function generateMultilingualSuggestions(humanProb, aiPatternAnalysis, humanPatternAnalysis, language) {
                const suggestions = [];
                const languageTemplates = {
                    'en': {
                        highHuman: ['‚úÖ Text shows strong human characteristics', '‚úì Good linguistic variety and personal expressiveness'],
                        mixed: ['üìù Text shows mixed characteristics', '‚úì Some human elements identified'],
                        likelyAI: ['ü§ñ Likely AI-generated content', '‚Ä¢ Multiple AI patterns detected'],
                        highAI: ['üö® HIGH PROBABILITY OF AI CONTENT', '‚Ä¢ Unequivocal AI patterns identified', '‚Ä¢ Typical AI generative structure'],
                        certainAI: ['üö® ALMOST CERTAINLY AI GENERATED', '‚Ä¢ Multiple artificial markers detected', '‚Ä¢ Exclusive ChatGPT patterns identified', '‚Ä¢ Complete rewrite recommended']
                    },
                    'pt': {
                        highHuman: ['‚úÖ Texto apresenta fortes caracter√≠sticas humanas', '‚úì Boa variedade lingu√≠stica e expressividade pessoal'],
                        mixed: ['üìù Texto apresenta caracter√≠sticas mistas', '‚úì Alguns elementos humanos identificados'],
                        likelyAI: ['ü§ñ Prov√°vel conte√∫do gerado por IA', '‚Ä¢ M√∫ltiplos padr√µes de IA detectados'],
                        highAI: ['üö® ALTA PROBABILIDADE DE CONTE√öDO DE IA', '‚Ä¢ Padr√µes inequ√≠vocos de IA identificados', '‚Ä¢ Estrutura t√≠pica de IA generativa'],
                        certainAI: ['üö® QUASE CERTAMENTE IA GENERATIVA', '‚Ä¢ M√∫ltiplos marcadores artificiais detectados', '‚Ä¢ Padr√µes exclusivos de ChatGPT identificados', '‚Ä¢ Recomenda-se reescrita completa']
                    },
                    'es': {
                        highHuman: ['‚úÖ Texto muestra fuertes caracter√≠sticas humanas', '‚úì Buena variedad ling√º√≠stica y expresividad personal'],
                        mixed: ['üìù Texto muestra caracter√≠sticas mixtas', '‚úì Algunos elementos humanos identificados'],
                        likelyAI: ['ü§ñ Probable contenido generado por IA', '‚Ä¢ M√∫ltiples patrones de IA detectados'],
                        highAI: ['üö® ALTA PROBABILIDAD DE CONTENIDO DE IA', '‚Ä¢ Patrones inequ√≠vocos de IA identificados', '‚Ä¢ Estructura t√≠pica de IA generativa'],
                        certainAI: ['üö® CASI SEGURAMENTE IA GENERATIVA', '‚Ä¢ M√∫ltiples marcadores artificiales detectados', '‚Ä¢ Patrones exclusivos de ChatGPT identificados', '‚Ä¢ Se recomienda reescritura completa']
                    }
                };

                const template = languageTemplates[language] || languageTemplates['en'];

                if (humanProb >= 70) {
                    suggestions.push(...template.highHuman);
                } else if (humanProb >= 50) {
                    suggestions.push(...template.mixed);
                } else if (humanProb >= 30) {
                    suggestions.push(...template.likelyAI);
                } else if (humanProb >= 15) {
                    suggestions.push(...template.highAI);
                } else {
                    suggestions.push(...template.certainAI);
                }

                if (aiPatternAnalysis.patterns.length > 0) {
                    suggestions.push(`‚Ä¢ ${aiPatternAnalysis.patterns.length} AI patterns detected`);
                }

                const markerCount = (currentAnalysisResult?.analyzedText.match(/\+\d+/g) || []).length;
                if (markerCount > 0) {
                    suggestions.push(`‚Ä¢ ${markerCount} artificial markers (+1, +2) found`);
                }

                return suggestions;
            }

            // Atualize a fun√ß√£o displayResults para mostrar o idioma detectado
            function displayResults(result) {
                // ... (c√≥digo anterior mantido)

                // Adicione informa√ß√£o do idioma
                const analysisDetails = document.getElementById('analysisDetails');
                analysisDetails.innerHTML = `
                    <div class="detail-item">
                        <strong>Detected Language:</strong> ${result.detectedLanguage.toUpperCase()}
                    </div>
                    <div class="detail-item">
                        <strong>Content Type:</strong> ${document.querySelector(`#contentType option[value="${result.contentType}"]`).textContent}
                    </div>
                    <div class="detail-item">
                        <strong>Text Statistics:</strong> ${result.wordCount} words, ${result.sentenceCount} sentences, ${result.paragraphCount} paragraphs
                    </div>
                    <div class="detail-item">
                        <strong>Artificial Markers:</strong> ${result.advancedMetrics.markerCount} occurrences of +1/+2
                    </div>
                    <div class="detail-item">
                        <strong>Technical Explanation:</strong> 
                        ${result.detailedExplanation.join('; ')}
                    </div>
                    <div class="detail-item">
                        <strong>AI Patterns Detected:</strong> ${result.aiPatternAnalysis.patterns.length} patterns
                    </div>
                    <div class="detail-item">
                        <strong>Human Patterns Detected:</strong> ${result.humanPatternAnalysis.patterns.length} patterns
                    </div>
                `;

                // ... (restante do c√≥digo mantido)
            }
        });

        // Mantenha todas as outras fun√ß√µes existentes (calculateLexicalRichness, analyzeSentenceVariety, etc.)
    </script>
</body>
</html>
